<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 11-testing: Testing - Laravel: From Zero to Production</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <link href="../styles.css" rel="stylesheet">
    <style>
        .markdown-content {
            line-height: 1.8;
            font-size: 1.1rem;
        }
        .markdown-content h1 {
            color: #ff2d20;
            border-bottom: 3px solid #ff2d20;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        .markdown-content h2 {
            color: #636b6f;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
            margin-top: 40px;
            margin-bottom: 20px;
        }
        .markdown-content h3 {
            color: #495057;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        .markdown-content h4 {
            color: #6c757d;
            margin-top: 25px;
            margin-bottom: 10px;
        }
        .markdown-content p {
            margin-bottom: 1.2rem;
        }
        .markdown-content ul, .markdown-content ol {
            margin-bottom: 1.5rem;
            padding-left: 2rem;
        }
        .markdown-content li {
            margin-bottom: 0.5rem;
        }
        .markdown-content code {
            background-color: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        .markdown-content pre {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            overflow-x: auto;
            margin: 20px 0;
        }
        .markdown-content pre code {
            background: none;
            padding: 0;
            border-radius: 0;
        }
        .markdown-content blockquote {
            border-left: 4px solid #ff2d20;
            margin: 20px 0;
            padding: 15px 20px;
            background-color: #f8f9fa;
            font-style: italic;
        }
        .markdown-content table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
        }
        .markdown-content th, .markdown-content td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        .markdown-content th {
            background-color: #ff2d20;
            color: white;
            font-weight: bold;
        }
        .markdown-content tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        .markdown-content strong {
            font-weight: 600;
            color: #495057;
        }
        .markdown-content em {
            color: #6c757d;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="../index.html">
                <i class="fab fa-laravel"></i> Laravel Book
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html#chapters">Chapters</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html#projects">Projects</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Chapter Content -->
    <div class="container mt-5 pt-5">
        <div class="row">
            <div class="col-lg-8 mx-auto">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="../index.html">Home</a></li>
                        <li class="breadcrumb-item"><a href="../index.html#chapters">Chapters</a></li>
                        <li class="breadcrumb-item active">Chapter 11-testing: Testing</li>
                    </ol>
                </nav>

                <article class="chapter-content">
                    <h1 class="display-4 text-gradient mb-4">
                        <i class="fas fa-vial"></i> Chapter 11-testing: Testing
                    </h1>
                    
                    
        <div class="markdown-content">
            <h1 id="chapter-11-testing">Chapter 11: Testing</h1>
<h2 id="what-is-testing">What is Testing?</h2>
<p>Testing is a crucial part of software development that helps ensure your code works correctly and continues to work as you make changes. Laravel provides excellent testing support with PHPUnit and additional testing helpers that make it easy to test your applications.</p>
<h2 id="types-of-tests">Types of Tests</h2>
<h3 id="unit-tests">Unit Tests</h3>
<p>Test individual components in isolation (models, services, helpers).</p>
<h3 id="feature-tests">Feature Tests</h3>
<p>Test complete features from the user's perspective (HTTP requests, database interactions).</p>
<h3 id="integration-tests">Integration Tests</h3>
<p>Test how different components work together.</p>
<h2 id="setting-up-testing">Setting Up Testing</h2>
<h3 id="phpunit-configuration">PHPUnit Configuration</h3>
<div class="codehilite"><pre><span></span><code><span class="cm">&lt;!-- phpunit.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;phpunit</span><span class="w"> </span><span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
<span class="w">         </span><span class="na">xsi:noNamespaceSchemaLocation=</span><span class="s">&quot;vendor/phpunit/phpunit/phpunit.xsd&quot;</span>
<span class="w">         </span><span class="na">bootstrap=</span><span class="s">&quot;vendor/autoload.php&quot;</span>
<span class="w">         </span><span class="na">colors=</span><span class="s">&quot;true&quot;</span>
<span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;testsuites&gt;</span>
<span class="w">        </span><span class="nt">&lt;testsuite</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Unit&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;directory</span><span class="w"> </span><span class="na">suffix=</span><span class="s">&quot;Test.php&quot;</span><span class="nt">&gt;</span>./tests/Unit<span class="nt">&lt;/directory&gt;</span>
<span class="w">        </span><span class="nt">&lt;/testsuite&gt;</span>
<span class="w">        </span><span class="nt">&lt;testsuite</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Feature&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;directory</span><span class="w"> </span><span class="na">suffix=</span><span class="s">&quot;Test.php&quot;</span><span class="nt">&gt;</span>./tests/Feature<span class="nt">&lt;/directory&gt;</span>
<span class="w">        </span><span class="nt">&lt;/testsuite&gt;</span>
<span class="w">    </span><span class="nt">&lt;/testsuites&gt;</span>
<span class="w">    </span><span class="nt">&lt;source&gt;</span>
<span class="w">        </span><span class="nt">&lt;include&gt;</span>
<span class="w">            </span><span class="nt">&lt;directory</span><span class="w"> </span><span class="na">suffix=</span><span class="s">&quot;.php&quot;</span><span class="nt">&gt;</span>./app<span class="nt">&lt;/directory&gt;</span>
<span class="w">        </span><span class="nt">&lt;/include&gt;</span>
<span class="w">    </span><span class="nt">&lt;/source&gt;</span>
<span class="w">    </span><span class="nt">&lt;php&gt;</span>
<span class="w">        </span><span class="nt">&lt;env</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;APP_ENV&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;testing&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;env</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;BCRYPT_ROUNDS&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;4&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;env</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;CACHE_DRIVER&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;array&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;env</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;DB_CONNECTION&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;sqlite&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;env</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;DB_DATABASE&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;:memory:&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;env</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;MAIL_MAILER&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;array&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;env</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;QUEUE_CONNECTION&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;sync&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;env</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;SESSION_DRIVER&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;array&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;env</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;TELESCOPE_ENABLED&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/php&gt;</span>
<span class="nt">&lt;/phpunit&gt;</span>
</code></pre></div>

<h3 id="test-database-configuration">Test Database Configuration</h3>
<div class="codehilite"><pre><span></span><code><span class="x">// config/database.php</span>
<span class="x">&#39;testing&#39; =&gt; [</span>
<span class="x">    &#39;driver&#39; =&gt; &#39;sqlite&#39;,</span>
<span class="x">    &#39;database&#39; =&gt; &#39;:memory:&#39;,</span>
<span class="x">    &#39;prefix&#39; =&gt; &#39;&#39;,</span>
<span class="x">],</span>
</code></pre></div>

<h2 id="running-tests">Running Tests</h2>
<h3 id="basic-commands">Basic Commands</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Run all tests</span>
php<span class="w"> </span>artisan<span class="w"> </span><span class="nb">test</span>

<span class="c1"># Run specific test file</span>
php<span class="w"> </span>artisan<span class="w"> </span><span class="nb">test</span><span class="w"> </span>tests/Feature/UserTest.php

<span class="c1"># Run specific test method</span>
php<span class="w"> </span>artisan<span class="w"> </span><span class="nb">test</span><span class="w"> </span>--filter<span class="w"> </span>test_user_can_register

<span class="c1"># Run tests with coverage</span>
php<span class="w"> </span>artisan<span class="w"> </span><span class="nb">test</span><span class="w"> </span>--coverage

<span class="c1"># Run tests in parallel</span>
php<span class="w"> </span>artisan<span class="w"> </span><span class="nb">test</span><span class="w"> </span>--parallel

<span class="c1"># Run tests with verbose output</span>
php<span class="w"> </span>artisan<span class="w"> </span><span class="nb">test</span><span class="w"> </span>--verbose
</code></pre></div>

<h3 id="using-phpunit-directly">Using PHPUnit Directly</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Run all tests</span>
./vendor/bin/phpunit

<span class="c1"># Run specific test suite</span>
./vendor/bin/phpunit<span class="w"> </span>--testsuite<span class="o">=</span>Feature

<span class="c1"># Run with coverage</span>
./vendor/bin/phpunit<span class="w"> </span>--coverage-html<span class="w"> </span>coverage
</code></pre></div>

<h2 id="feature-tests_1">Feature Tests</h2>
<h3 id="creating-feature-tests">Creating Feature Tests</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Create feature test</span>
php<span class="w"> </span>artisan<span class="w"> </span>make:test<span class="w"> </span>UserTest

<span class="c1"># Create test for specific model</span>
php<span class="w"> </span>artisan<span class="w"> </span>make:test<span class="w"> </span>UserTest<span class="w"> </span>--model<span class="o">=</span>User
</code></pre></div>

<h3 id="basic-feature-test-structure">Basic Feature Test Structure</h3>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="k">namespace</span> <span class="nx">Tests\Feature</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">App\Models\User</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Foundation\Testing\RefreshDatabase</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Tests\TestCase</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">UserTest</span> <span class="k">extends</span> <span class="nx">TestCase</span>
<span class="p">{</span>
    <span class="k">use</span> <span class="nx">RefreshDatabase</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">test_user_can_register</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="nv">$response</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;/register&#39;</span><span class="p">,</span> <span class="p">[</span>
            <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;John Doe&#39;</span><span class="p">,</span>
            <span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;john@example.com&#39;</span><span class="p">,</span>
            <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span>
            <span class="s1">&#39;password_confirmation&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span>
        <span class="p">]);</span>

        <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">assertStatus</span><span class="p">(</span><span class="mi">302</span><span class="p">);</span>
        <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">assertRedirect</span><span class="p">(</span><span class="s1">&#39;/home&#39;</span><span class="p">);</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertDatabaseHas</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="p">[</span>
            <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;John Doe&#39;</span><span class="p">,</span>
            <span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;john@example.com&#39;</span><span class="p">,</span>
        <span class="p">]);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">test_user_can_login</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="nv">$user</span> <span class="o">=</span> <span class="nx">User</span><span class="o">::</span><span class="na">factory</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">();</span>

        <span class="nv">$response</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span> <span class="p">[</span>
            <span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">email</span><span class="p">,</span>
            <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span>
        <span class="p">]);</span>

        <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">assertStatus</span><span class="p">(</span><span class="mi">302</span><span class="p">);</span>
        <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">assertRedirect</span><span class="p">(</span><span class="s1">&#39;/home&#39;</span><span class="p">);</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertAuthenticated</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">test_user_cannot_access_protected_route</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="nv">$response</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/profile&#39;</span><span class="p">);</span>

        <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">assertStatus</span><span class="p">(</span><span class="mi">302</span><span class="p">);</span>
        <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">assertRedirect</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="http-testing">HTTP Testing</h3>
<div class="codehilite"><pre><span></span><code><span class="x">class HttpTest extends TestCase</span>
<span class="x">{</span>
<span class="x">    public function test_get_request(): void</span>
<span class="x">    {</span>
<span class="x">        $response = $this-&gt;get(&#39;/users&#39;);</span>

<span class="x">        $response-&gt;assertStatus(200);</span>
<span class="x">        $response-&gt;assertViewIs(&#39;users.index&#39;);</span>
<span class="x">    }</span>

<span class="x">    public function test_post_request(): void</span>
<span class="x">    {</span>
<span class="x">        $response = $this-&gt;post(&#39;/users&#39;, [</span>
<span class="x">            &#39;name&#39; =&gt; &#39;John Doe&#39;,</span>
<span class="x">            &#39;email&#39; =&gt; &#39;john@example.com&#39;,</span>
<span class="x">        ]);</span>

<span class="x">        $response-&gt;assertStatus(302);</span>
<span class="x">        $response-&gt;assertRedirect(&#39;/users&#39;);</span>
<span class="x">    }</span>

<span class="x">    public function test_put_request(): void</span>
<span class="x">    {</span>
<span class="x">        $user = User::factory()-&gt;create();</span>

<span class="x">        $response = $this-&gt;put(&quot;/users/{$user-&gt;id}&quot;, [</span>
<span class="x">            &#39;name&#39; =&gt; &#39;Jane Doe&#39;,</span>
<span class="x">            &#39;email&#39; =&gt; &#39;jane@example.com&#39;,</span>
<span class="x">        ]);</span>

<span class="x">        $response-&gt;assertStatus(302);</span>

<span class="x">        $this-&gt;assertDatabaseHas(&#39;users&#39;, [</span>
<span class="x">            &#39;id&#39; =&gt; $user-&gt;id,</span>
<span class="x">            &#39;name&#39; =&gt; &#39;Jane Doe&#39;,</span>
<span class="x">        ]);</span>
<span class="x">    }</span>

<span class="x">    public function test_delete_request(): void</span>
<span class="x">    {</span>
<span class="x">        $user = User::factory()-&gt;create();</span>

<span class="x">        $response = $this-&gt;delete(&quot;/users/{$user-&gt;id}&quot;);</span>

<span class="x">        $response-&gt;assertStatus(302);</span>

<span class="x">        $this-&gt;assertDatabaseMissing(&#39;users&#39;, [</span>
<span class="x">            &#39;id&#39; =&gt; $user-&gt;id,</span>
<span class="x">        ]);</span>
<span class="x">    }</span>
<span class="x">}</span>
</code></pre></div>

<h3 id="response-assertions">Response Assertions</h3>
<div class="codehilite"><pre><span></span><code><span class="x">class ResponseTest extends TestCase</span>
<span class="x">{</span>
<span class="x">    public function test_response_assertions(): void</span>
<span class="x">    {</span>
<span class="x">        $response = $this-&gt;get(&#39;/users&#39;);</span>

<span class="x">        // Status assertions</span>
<span class="x">        $response-&gt;assertStatus(200);</span>
<span class="x">        $response-&gt;assertOk();</span>
<span class="x">        $response-&gt;assertNotFound();</span>
<span class="x">        $response-&gt;assertForbidden();</span>
<span class="x">        $response-&gt;assertUnauthorized();</span>

<span class="x">        // Redirect assertions</span>
<span class="x">        $response-&gt;assertRedirect(&#39;/login&#39;);</span>
<span class="x">        $response-&gt;assertRedirect(route(&#39;login&#39;));</span>

<span class="x">        // View assertions</span>
<span class="x">        $response-&gt;assertViewIs(&#39;users.index&#39;);</span>
<span class="x">        $response-&gt;assertViewHas(&#39;users&#39;);</span>
<span class="x">        $response-&gt;assertViewHas(&#39;users&#39;, $users);</span>

<span class="x">        // JSON assertions</span>
<span class="x">        $response-&gt;assertJson([&#39;name&#39; =&gt; &#39;John Doe&#39;]);</span>
<span class="x">        $response-&gt;assertJsonFragment([&#39;name&#39; =&gt; &#39;John Doe&#39;]);</span>
<span class="x">        $response-&gt;assertJsonMissing([&#39;password&#39;]);</span>

<span class="x">        // Header assertions</span>
<span class="x">        $response-&gt;assertHeader(&#39;Content-Type&#39;, &#39;application/json&#39;);</span>
<span class="x">        $response-&gt;assertHeaderMissing(&#39;X-Custom-Header&#39;);</span>

<span class="x">        // Cookie assertions</span>
<span class="x">        $response-&gt;assertCookie(&#39;name&#39;, &#39;value&#39;);</span>
<span class="x">        $response-&gt;assertCookieMissing(&#39;name&#39;);</span>

<span class="x">        // Session assertions</span>
<span class="x">        $response-&gt;assertSessionHas(&#39;key&#39;);</span>
<span class="x">        $response-&gt;assertSessionHas(&#39;key&#39;, &#39;value&#39;);</span>
<span class="x">        $response-&gt;assertSessionMissing(&#39;key&#39;);</span>
<span class="x">        $response-&gt;assertSessionHasErrors([&#39;email&#39;]);</span>
<span class="x">        $response-&gt;assertSessionHasNoErrors();</span>
<span class="x">    }</span>
<span class="x">}</span>
</code></pre></div>

<h3 id="authentication-testing">Authentication Testing</h3>
<div class="codehilite"><pre><span></span><code><span class="x">class AuthenticationTest extends TestCase</span>
<span class="x">{</span>
<span class="x">    public function test_guest_cannot_access_protected_route(): void</span>
<span class="x">    {</span>
<span class="x">        $response = $this-&gt;get(&#39;/profile&#39;);</span>

<span class="x">        $response-&gt;assertRedirect(&#39;/login&#39;);</span>
<span class="x">    }</span>

<span class="x">    public function test_authenticated_user_can_access_protected_route(): void</span>
<span class="x">    {</span>
<span class="x">        $user = User::factory()-&gt;create();</span>

<span class="x">        $response = $this-&gt;actingAs($user)-&gt;get(&#39;/profile&#39;);</span>

<span class="x">        $response-&gt;assertOk();</span>
<span class="x">        $this-&gt;assertAuthenticated();</span>
<span class="x">    }</span>

<span class="x">    public function test_user_can_logout(): void</span>
<span class="x">    {</span>
<span class="x">        $user = User::factory()-&gt;create();</span>

<span class="x">        $response = $this-&gt;actingAs($user)-&gt;post(&#39;/logout&#39;);</span>

<span class="x">        $response-&gt;assertRedirect(&#39;/&#39;);</span>
<span class="x">        $this-&gt;assertGuest();</span>
<span class="x">    }</span>
<span class="x">}</span>
</code></pre></div>

<h2 id="unit-tests_1">Unit Tests</h2>
<h3 id="creating-unit-tests">Creating Unit Tests</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Create unit test</span>
php<span class="w"> </span>artisan<span class="w"> </span>make:test<span class="w"> </span>UserTest<span class="w"> </span>--unit

<span class="c1"># Create test for specific class</span>
php<span class="w"> </span>artisan<span class="w"> </span>make:test<span class="w"> </span>UserServiceTest<span class="w"> </span>--unit
</code></pre></div>

<h3 id="testing-models">Testing Models</h3>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="k">namespace</span> <span class="nx">Tests\Unit</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">App\Models\User</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Foundation\Testing\RefreshDatabase</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Tests\TestCase</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">UserTest</span> <span class="k">extends</span> <span class="nx">TestCase</span>
<span class="p">{</span>
    <span class="k">use</span> <span class="nx">RefreshDatabase</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">test_user_has_full_name</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="nv">$user</span> <span class="o">=</span> <span class="nx">User</span><span class="o">::</span><span class="na">factory</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">([</span>
            <span class="s1">&#39;first_name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;John&#39;</span><span class="p">,</span>
            <span class="s1">&#39;last_name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Doe&#39;</span><span class="p">,</span>
        <span class="p">]);</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertEquals</span><span class="p">(</span><span class="s1">&#39;John Doe&#39;</span><span class="p">,</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">full_name</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">test_user_can_be_admin</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="nv">$user</span> <span class="o">=</span> <span class="nx">User</span><span class="o">::</span><span class="na">factory</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">([</span><span class="s1">&#39;role&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;admin&#39;</span><span class="p">]);</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertTrue</span><span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">isAdmin</span><span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">test_user_has_many_posts</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="nv">$user</span> <span class="o">=</span> <span class="nx">User</span><span class="o">::</span><span class="na">factory</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">();</span>
        <span class="nv">$posts</span> <span class="o">=</span> <span class="nx">Post</span><span class="o">::</span><span class="na">factory</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">count</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">([</span><span class="s1">&#39;user_id&#39;</span> <span class="o">=&gt;</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">id</span><span class="p">]);</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertCount</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">posts</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertInstanceOf</span><span class="p">(</span><span class="nx">Post</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">posts</span><span class="o">-&gt;</span><span class="na">first</span><span class="p">());</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="testing-services">Testing Services</h3>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="k">namespace</span> <span class="nx">Tests\Unit</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">App\Services\UserService</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">App\Models\User</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Foundation\Testing\RefreshDatabase</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Tests\TestCase</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">UserServiceTest</span> <span class="k">extends</span> <span class="nx">TestCase</span>
<span class="p">{</span>
    <span class="k">use</span> <span class="nx">RefreshDatabase</span><span class="p">;</span>

    <span class="k">protected</span> <span class="nx">UserService</span> <span class="nv">$userService</span><span class="p">;</span>

    <span class="k">protected</span> <span class="k">function</span> <span class="nf">setUp</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setUp</span><span class="p">();</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">userService</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">UserService</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">test_create_user</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="nv">$userData</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;John Doe&#39;</span><span class="p">,</span>
            <span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;john@example.com&#39;</span><span class="p">,</span>
            <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span>
        <span class="p">];</span>

        <span class="nv">$user</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">userService</span><span class="o">-&gt;</span><span class="na">createUser</span><span class="p">(</span><span class="nv">$userData</span><span class="p">);</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertInstanceOf</span><span class="p">(</span><span class="nx">User</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="nv">$user</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertEquals</span><span class="p">(</span><span class="s1">&#39;John Doe&#39;</span><span class="p">,</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertEquals</span><span class="p">(</span><span class="s1">&#39;john@example.com&#39;</span><span class="p">,</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">email</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">test_update_user</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="nv">$user</span> <span class="o">=</span> <span class="nx">User</span><span class="o">::</span><span class="na">factory</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">();</span>
        <span class="nv">$updateData</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Jane Doe&#39;</span><span class="p">];</span>

        <span class="nv">$updatedUser</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">userService</span><span class="o">-&gt;</span><span class="na">updateUser</span><span class="p">(</span><span class="nv">$user</span><span class="p">,</span> <span class="nv">$updateData</span><span class="p">);</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertEquals</span><span class="p">(</span><span class="s1">&#39;Jane Doe&#39;</span><span class="p">,</span> <span class="nv">$updatedUser</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">test_delete_user</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="nv">$user</span> <span class="o">=</span> <span class="nx">User</span><span class="o">::</span><span class="na">factory</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">();</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">userService</span><span class="o">-&gt;</span><span class="na">deleteUser</span><span class="p">(</span><span class="nv">$user</span><span class="p">);</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertDatabaseMissing</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">id</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="database-testing">Database Testing</h2>
<h3 id="database-assertions">Database Assertions</h3>
<div class="codehilite"><pre><span></span><code><span class="x">class DatabaseTest extends TestCase</span>
<span class="x">{</span>
<span class="x">    use RefreshDatabase;</span>

<span class="x">    public function test_database_assertions(): void</span>
<span class="x">    {</span>
<span class="x">        $user = User::factory()-&gt;create();</span>

<span class="x">        // Assert record exists</span>
<span class="x">        $this-&gt;assertDatabaseHas(&#39;users&#39;, [</span>
<span class="x">            &#39;id&#39; =&gt; $user-&gt;id,</span>
<span class="x">            &#39;name&#39; =&gt; $user-&gt;name,</span>
<span class="x">        ]);</span>

<span class="x">        // Assert record doesn&#39;t exist</span>
<span class="x">        $this-&gt;assertDatabaseMissing(&#39;users&#39;, [</span>
<span class="x">            &#39;email&#39; =&gt; &#39;nonexistent@example.com&#39;,</span>
<span class="x">        ]);</span>

<span class="x">        // Assert count</span>
<span class="x">        $this-&gt;assertDatabaseCount(&#39;users&#39;, 1);</span>

<span class="x">        // Assert table is empty</span>
<span class="x">        $this-&gt;assertDatabaseEmpty(&#39;posts&#39;);</span>
<span class="x">    }</span>

<span class="x">    public function test_soft_deletes(): void</span>
<span class="x">    {</span>
<span class="x">        $user = User::factory()-&gt;create();</span>
<span class="x">        $user-&gt;delete();</span>

<span class="x">        // Assert record is soft deleted</span>
<span class="x">        $this-&gt;assertSoftDeleted(&#39;users&#39;, [&#39;id&#39; =&gt; $user-&gt;id]);</span>

<span class="x">        // Assert record exists in database but is soft deleted</span>
<span class="x">        $this-&gt;assertDatabaseHas(&#39;users&#39;, [&#39;id&#39; =&gt; $user-&gt;id]);</span>
<span class="x">    }</span>
<span class="x">}</span>
</code></pre></div>

<h3 id="database-factories">Database Factories</h3>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="k">namespace</span> <span class="nx">Database\Factories</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">App\Models\User</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Factories\Factory</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Support\Str</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">UserFactory</span> <span class="k">extends</span> <span class="nx">Factory</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="nv">$model</span> <span class="o">=</span> <span class="nx">User</span><span class="o">::</span><span class="na">class</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">definition</span><span class="p">()</span><span class="o">:</span> <span class="k">array</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">faker</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">(),</span>
            <span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">faker</span><span class="o">-&gt;</span><span class="na">unique</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">safeEmail</span><span class="p">(),</span>
            <span class="s1">&#39;email_verified_at&#39;</span> <span class="o">=&gt;</span> <span class="nx">now</span><span class="p">(),</span>
            <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi&#39;</span><span class="p">,</span> <span class="c1">// password</span>
            <span class="s1">&#39;remember_token&#39;</span> <span class="o">=&gt;</span> <span class="nx">Str</span><span class="o">::</span><span class="na">random</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
        <span class="p">];</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">unverified</span><span class="p">()</span><span class="o">:</span> <span class="k">static</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">state</span><span class="p">(</span><span class="nx">fn</span> <span class="p">(</span><span class="k">array</span> <span class="nv">$attributes</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;email_verified_at&#39;</span> <span class="o">=&gt;</span> <span class="k">null</span><span class="p">,</span>
        <span class="p">]);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">admin</span><span class="p">()</span><span class="o">:</span> <span class="k">static</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">state</span><span class="p">(</span><span class="nx">fn</span> <span class="p">(</span><span class="k">array</span> <span class="nv">$attributes</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;role&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;admin&#39;</span><span class="p">,</span>
        <span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="using-factories-in-tests">Using Factories in Tests</h3>
<div class="codehilite"><pre><span></span><code><span class="x">class FactoryTest extends TestCase</span>
<span class="x">{</span>
<span class="x">    use RefreshDatabase;</span>

<span class="x">    public function test_using_factories(): void</span>
<span class="x">    {</span>
<span class="x">        // Create single user</span>
<span class="x">        $user = User::factory()-&gt;create();</span>

<span class="x">        // Create user with specific attributes</span>
<span class="x">        $admin = User::factory()-&gt;create([&#39;role&#39; =&gt; &#39;admin&#39;]);</span>

<span class="x">        // Create multiple users</span>
<span class="x">        $users = User::factory()-&gt;count(5)-&gt;create();</span>

<span class="x">        // Create user with state</span>
<span class="x">        $unverifiedUser = User::factory()-&gt;unverified()-&gt;create();</span>

<span class="x">        // Create user with relationships</span>
<span class="x">        $userWithPosts = User::factory()</span>
<span class="x">            -&gt;has(Post::factory()-&gt;count(3))</span>
<span class="x">            -&gt;create();</span>

<span class="x">        // Create user without saving</span>
<span class="x">        $user = User::factory()-&gt;make();</span>

<span class="x">        // Create user with raw attributes</span>
<span class="x">        $userData = User::factory()-&gt;raw();</span>
<span class="x">    }</span>
<span class="x">}</span>
</code></pre></div>

<h2 id="mocking-and-stubbing">Mocking and Stubbing</h2>
<h3 id="mocking-services">Mocking Services</h3>
<div class="codehilite"><pre><span></span><code><span class="x">use Mockery;</span>
<span class="x">use App\Services\EmailService;</span>

<span class="x">class MockTest extends TestCase</span>
<span class="x">{</span>
<span class="x">    public function test_mocking_service(): void</span>
<span class="x">    {</span>
<span class="x">        $mock = Mockery::mock(EmailService::class);</span>
<span class="x">        $mock-&gt;shouldReceive(&#39;send&#39;)</span>
<span class="x">            -&gt;once()</span>
<span class="x">            -&gt;with(&#39;john@example.com&#39;, &#39;Welcome!&#39;)</span>
<span class="x">            -&gt;andReturn(true);</span>

<span class="x">        app()-&gt;instance(EmailService::class, $mock);</span>

<span class="x">        $user = User::factory()-&gt;create();</span>

<span class="x">        // Your code that uses EmailService</span>
<span class="x">        $this-&gt;assertTrue($mock-&gt;send(&#39;john@example.com&#39;, &#39;Welcome!&#39;));</span>
<span class="x">    }</span>

<span class="x">    public function test_partial_mock(): void</span>
<span class="x">    {</span>
<span class="x">        $user = User::factory()-&gt;create();</span>

<span class="x">        $mock = Mockery::mock($user)-&gt;makePartial();</span>
<span class="x">        $mock-&gt;shouldReceive(&#39;sendEmail&#39;)</span>
<span class="x">            -&gt;once()</span>
<span class="x">            -&gt;andReturn(true);</span>

<span class="x">        $this-&gt;assertTrue($mock-&gt;sendEmail());</span>
<span class="x">    }</span>
<span class="x">}</span>
</code></pre></div>

<h3 id="mocking-http-requests">Mocking HTTP Requests</h3>
<div class="codehilite"><pre><span></span><code><span class="x">use Illuminate\Support\Facades\Http;</span>

<span class="x">class HttpMockTest extends TestCase</span>
<span class="x">{</span>
<span class="x">    public function test_mocking_http_requests(): void</span>
<span class="x">    {</span>
<span class="x">        Http::fake([</span>
<span class="x">            &#39;api.example.com/*&#39; =&gt; Http::response([</span>
<span class="x">                &#39;id&#39; =&gt; 1,</span>
<span class="x">                &#39;name&#39; =&gt; &#39;John Doe&#39;,</span>
<span class="x">            ], 200),</span>
<span class="x">        ]);</span>

<span class="x">        $response = Http::get(&#39;api.example.com/users/1&#39;);</span>

<span class="x">        $this-&gt;assertEquals(200, $response-&gt;status());</span>
<span class="x">        $this-&gt;assertEquals(&#39;John Doe&#39;, $response-&gt;json(&#39;name&#39;));</span>

<span class="x">        Http::assertSent(function ($request) {</span>
<span class="x">            return $request-&gt;url() == &#39;api.example.com/users/1&#39; &amp;&amp;</span>
<span class="x">                   $request-&gt;method() == &#39;GET&#39;;</span>
<span class="x">        });</span>
<span class="x">    }</span>
<span class="x">}</span>
</code></pre></div>

<h2 id="testing-events-and-jobs">Testing Events and Jobs</h2>
<h3 id="testing-events">Testing Events</h3>
<div class="codehilite"><pre><span></span><code><span class="x">use App\Events\UserRegistered;</span>
<span class="x">use Illuminate\Support\Facades\Event;</span>

<span class="x">class EventTest extends TestCase</span>
<span class="x">{</span>
<span class="x">    public function test_event_is_dispatched(): void</span>
<span class="x">    {</span>
<span class="x">        Event::fake();</span>

<span class="x">        $user = User::factory()-&gt;create();</span>

<span class="x">        UserRegistered::dispatch($user);</span>

<span class="x">        Event::assertDispatched(UserRegistered::class);</span>
<span class="x">        Event::assertDispatched(UserRegistered::class, function ($event) use ($user) {</span>
<span class="x">            return $event-&gt;user-&gt;id === $user-&gt;id;</span>
<span class="x">        });</span>
<span class="x">    }</span>

<span class="x">    public function test_event_is_not_dispatched(): void</span>
<span class="x">    {</span>
<span class="x">        Event::fake();</span>

<span class="x">        $user = User::factory()-&gt;create();</span>

<span class="x">        Event::assertNotDispatched(UserRegistered::class);</span>
<span class="x">    }</span>
<span class="x">}</span>
</code></pre></div>

<h3 id="testing-jobs">Testing Jobs</h3>
<div class="codehilite"><pre><span></span><code><span class="x">use App\Jobs\SendWelcomeEmail;</span>
<span class="x">use Illuminate\Support\Facades\Queue;</span>

<span class="x">class JobTest extends TestCase</span>
<span class="x">{</span>
<span class="x">    public function test_job_is_dispatched(): void</span>
<span class="x">    {</span>
<span class="x">        Queue::fake();</span>

<span class="x">        $user = User::factory()-&gt;create();</span>

<span class="x">        SendWelcomeEmail::dispatch($user);</span>

<span class="x">        Queue::assertPushed(SendWelcomeEmail::class);</span>
<span class="x">        Queue::assertPushed(SendWelcomeEmail::class, function ($job) use ($user) {</span>
<span class="x">            return $job-&gt;user-&gt;id === $user-&gt;id;</span>
<span class="x">        });</span>
<span class="x">    }</span>

<span class="x">    public function test_job_is_not_dispatched(): void</span>
<span class="x">    {</span>
<span class="x">        Queue::fake();</span>

<span class="x">        $user = User::factory()-&gt;create();</span>

<span class="x">        Queue::assertNotPushed(SendWelcomeEmail::class);</span>
<span class="x">    }</span>
<span class="x">}</span>
</code></pre></div>

<h2 id="testing-mail-and-notifications">Testing Mail and Notifications</h2>
<h3 id="testing-mail">Testing Mail</h3>
<div class="codehilite"><pre><span></span><code><span class="x">use App\Mail\WelcomeEmail;</span>
<span class="x">use Illuminate\Support\Facades\Mail;</span>

<span class="x">class MailTest extends TestCase</span>
<span class="x">{</span>
<span class="x">    public function test_mail_is_sent(): void</span>
<span class="x">    {</span>
<span class="x">        Mail::fake();</span>

<span class="x">        $user = User::factory()-&gt;create();</span>

<span class="x">        Mail::to($user-&gt;email)-&gt;send(new WelcomeEmail($user));</span>

<span class="x">        Mail::assertSent(WelcomeEmail::class);</span>
<span class="x">        Mail::assertSent(WelcomeEmail::class, function ($mail) use ($user) {</span>
<span class="x">            return $mail-&gt;hasTo($user-&gt;email);</span>
<span class="x">        });</span>
<span class="x">    }</span>

<span class="x">    public function test_mail_is_not_sent(): void</span>
<span class="x">    {</span>
<span class="x">        Mail::fake();</span>

<span class="x">        $user = User::factory()-&gt;create();</span>

<span class="x">        Mail::assertNotSent(WelcomeEmail::class);</span>
<span class="x">    }</span>
<span class="x">}</span>
</code></pre></div>

<h3 id="testing-notifications">Testing Notifications</h3>
<div class="codehilite"><pre><span></span><code><span class="x">use App\Notifications\WelcomeNotification;</span>
<span class="x">use Illuminate\Support\Facades\Notification;</span>

<span class="x">class NotificationTest extends TestCase</span>
<span class="x">{</span>
<span class="x">    public function test_notification_is_sent(): void</span>
<span class="x">    {</span>
<span class="x">        Notification::fake();</span>

<span class="x">        $user = User::factory()-&gt;create();</span>

<span class="x">        $user-&gt;notify(new WelcomeNotification());</span>

<span class="x">        Notification::assertSentTo($user, WelcomeNotification::class);</span>
<span class="x">    }</span>
<span class="x">}</span>
</code></pre></div>

<h2 id="testing-api-endpoints">Testing API Endpoints</h2>
<h3 id="api-testing">API Testing</h3>
<div class="codehilite"><pre><span></span><code><span class="x">class ApiTest extends TestCase</span>
<span class="x">{</span>
<span class="x">    public function test_api_endpoint(): void</span>
<span class="x">    {</span>
<span class="x">        $user = User::factory()-&gt;create();</span>

<span class="x">        $response = $this-&gt;actingAs($user)</span>
<span class="x">            -&gt;getJson(&#39;/api/users&#39;);</span>

<span class="x">        $response-&gt;assertStatus(200)</span>
<span class="x">            -&gt;assertJsonStructure([</span>
<span class="x">                &#39;data&#39; =&gt; [</span>
<span class="x">                    &#39;*&#39; =&gt; [&#39;id&#39;, &#39;name&#39;, &#39;email&#39;]</span>
<span class="x">                ]</span>
<span class="x">            ]);</span>
<span class="x">    }</span>

<span class="x">    public function test_api_validation(): void</span>
<span class="x">    {</span>
<span class="x">        $response = $this-&gt;postJson(&#39;/api/users&#39;, []);</span>

<span class="x">        $response-&gt;assertStatus(422)</span>
<span class="x">            -&gt;assertJsonValidationErrors([&#39;name&#39;, &#39;email&#39;]);</span>
<span class="x">    }</span>

<span class="x">    public function test_api_authentication(): void</span>
<span class="x">    {</span>
<span class="x">        $response = $this-&gt;getJson(&#39;/api/profile&#39;);</span>

<span class="x">        $response-&gt;assertStatus(401);</span>
<span class="x">    }</span>
<span class="x">}</span>
</code></pre></div>

<h2 id="test-data-providers">Test Data Providers</h2>
<h3 id="using-data-providers">Using Data Providers</h3>
<div class="codehilite"><pre><span></span><code><span class="x">class DataProviderTest extends TestCase</span>
<span class="x">{</span>
<span class="x">    /**</span>
<span class="x">     * @dataProvider userDataProvider</span>
<span class="x">     */</span>
<span class="x">    public function test_user_validation($name, $email, $expectedStatus): void</span>
<span class="x">    {</span>
<span class="x">        $response = $this-&gt;post(&#39;/users&#39;, [</span>
<span class="x">            &#39;name&#39; =&gt; $name,</span>
<span class="x">            &#39;email&#39; =&gt; $email,</span>
<span class="x">        ]);</span>

<span class="x">        $response-&gt;assertStatus($expectedStatus);</span>
<span class="x">    }</span>

<span class="x">    public function userDataProvider(): array</span>
<span class="x">    {</span>
<span class="x">        return [</span>
<span class="x">            &#39;valid user&#39; =&gt; [&#39;John Doe&#39;, &#39;john@example.com&#39;, 302],</span>
<span class="x">            &#39;invalid email&#39; =&gt; [&#39;John Doe&#39;, &#39;invalid-email&#39;, 422],</span>
<span class="x">            &#39;empty name&#39; =&gt; [&#39;&#39;, &#39;john@example.com&#39;, 422],</span>
<span class="x">        ];</span>
<span class="x">    }</span>
<span class="x">}</span>
</code></pre></div>

<h2 id="testing-best-practices">Testing Best Practices</h2>
<h3 id="1-use-descriptive-test-names">1. Use Descriptive Test Names</h3>
<div class="codehilite"><pre><span></span><code><span class="x">// Good</span>
<span class="x">public function test_user_can_register_with_valid_data(): void</span>
<span class="x">public function test_user_cannot_register_with_invalid_email(): void</span>
<span class="x">public function test_admin_can_delete_any_user(): void</span>

<span class="x">// Bad</span>
<span class="x">public function test_register(): void</span>
<span class="x">public function test_email(): void</span>
<span class="x">public function test_delete(): void</span>
</code></pre></div>

<h3 id="2-follow-aaa-pattern">2. Follow AAA Pattern</h3>
<div class="codehilite"><pre><span></span><code><span class="x">public function test_user_can_login(): void</span>
<span class="x">{</span>
<span class="x">    // Arrange</span>
<span class="x">    $user = User::factory()-&gt;create();</span>

<span class="x">    // Act</span>
<span class="x">    $response = $this-&gt;post(&#39;/login&#39;, [</span>
<span class="x">        &#39;email&#39; =&gt; $user-&gt;email,</span>
<span class="x">        &#39;password&#39; =&gt; &#39;password&#39;,</span>
<span class="x">    ]);</span>

<span class="x">    // Assert</span>
<span class="x">    $response-&gt;assertRedirect(&#39;/home&#39;);</span>
<span class="x">    $this-&gt;assertAuthenticated();</span>
<span class="x">}</span>
</code></pre></div>

<h3 id="3-test-one-thing-at-a-time">3. Test One Thing at a Time</h3>
<div class="codehilite"><pre><span></span><code><span class="x">// Good - Single responsibility</span>
<span class="x">public function test_user_can_register(): void</span>
<span class="x">{</span>
<span class="x">    // Test registration only</span>
<span class="x">}</span>

<span class="x">public function test_user_can_login(): void</span>
<span class="x">{</span>
<span class="x">    // Test login only</span>
<span class="x">}</span>

<span class="x">// Bad - Multiple responsibilities</span>
<span class="x">public function test_user_authentication(): void</span>
<span class="x">{</span>
<span class="x">    // Testing registration, login, and logout in one test</span>
<span class="x">}</span>
</code></pre></div>

<h3 id="4-use-factories-for-test-data">4. Use Factories for Test Data</h3>
<div class="codehilite"><pre><span></span><code><span class="x">// Good</span>
<span class="x">$user = User::factory()-&gt;create();</span>

<span class="x">// Bad</span>
<span class="x">$user = new User();</span>
<span class="x">$user-&gt;name = &#39;John Doe&#39;;</span>
<span class="x">$user-&gt;email = &#39;john@example.com&#39;;</span>
<span class="x">$user-&gt;save();</span>
</code></pre></div>

<h3 id="5-test-edge-cases">5. Test Edge Cases</h3>
<div class="codehilite"><pre><span></span><code><span class="x">public function test_user_cannot_register_with_existing_email(): void</span>
<span class="x">{</span>
<span class="x">    $existingUser = User::factory()-&gt;create();</span>

<span class="x">    $response = $this-&gt;post(&#39;/register&#39;, [</span>
<span class="x">        &#39;name&#39; =&gt; &#39;John Doe&#39;,</span>
<span class="x">        &#39;email&#39; =&gt; $existingUser-&gt;email,</span>
<span class="x">        &#39;password&#39; =&gt; &#39;password&#39;,</span>
<span class="x">    ]);</span>

<span class="x">    $response-&gt;assertSessionHasErrors([&#39;email&#39;]);</span>
<span class="x">}</span>
</code></pre></div>

<h3 id="6-use-database-transactions">6. Use Database Transactions</h3>
<div class="codehilite"><pre><span></span><code><span class="x">use Illuminate\Foundation\Testing\DatabaseTransactions;</span>

<span class="x">class TransactionTest extends TestCase</span>
<span class="x">{</span>
<span class="x">    use DatabaseTransactions;</span>

<span class="x">    // Tests will run in transactions and be rolled back</span>
<span class="x">}</span>
</code></pre></div>

<h2 id="summary">Summary</h2>
<p>In this chapter, we covered:</p>
<ul>
<li> Setting up testing environment</li>
<li> Feature tests for HTTP requests</li>
<li> Unit tests for individual components</li>
<li> Database testing and factories</li>
<li> Mocking and stubbing</li>
<li> Testing events and jobs</li>
<li> Testing mail and notifications</li>
<li> API testing</li>
<li> Test data providers</li>
<li> Testing best practices</li>
</ul>
<p>Testing is essential for building reliable and maintainable applications. In the next chapter, we'll explore deployment strategies for Laravel applications.</p>
        </div>
        

                    <!-- Markdown Source Link -->
                    <div class="card mt-4">
                        <div class="card-body text-center">
                            <p class="mb-2">
                                <i class="fas fa-file-markdown text-primary"></i>
                                <strong>View Source:</strong>
                            </p>
                            <a href="../docs/11-testing.md" class="btn btn-outline-primary" target="_blank">
                                <i class="fas fa-external-link-alt"></i> Open Markdown File
                            </a>
                        </div>
                    </div>

                    <div class="d-flex justify-content-between mt-5">
                        <a href="../index.html" class="btn btn-outline-primary">
                            <i class="fas fa-home"></i> Back to Home
                        </a>
                        <div>
                            <a href="10-events-queues.html" class="btn btn-outline-secondary me-2"><i class="fas fa-arrow-left"></i> Previous</a>
                            <a href="12-deployment.html" class="btn btn-primary">Next <i class="fas fa-arrow-right"></i></a>
                        </div>
                    </div>
                </article>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-white text-center py-4 mt-5">
        <div class="container">
            <p>&copy; 2024 Laravel: From Zero to Production. All rights reserved.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="../script.js"></script>
</body>
</html>